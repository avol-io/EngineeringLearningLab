{"version":3,"sources":["../src/app/proposal/proposal-list/proposal-list.component.ts"],"names":[],"mappings":"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","file":"proposal-list.component.js","sourcesContent":["import { Component, OnInit, Output, EventEmitter } from '@angular/core';\nimport * as _ from \"lodash\";\nimport * as $ from 'jquery';\n\nimport { Proposal } from '../../shared/models/proposal.model';\nimport { ProposalCriteria } from '../../shared/models/proposal-criteria.model';\nimport { UserAccount } from '../../shared/models/user-acount.model';\n\nimport { ProposalService } from '../../shared/services/proposal.service';\nimport { SortService } from '../../shared/services/sort/sort.service';\nimport { FilterService } from '../../shared/services/filter/filter.service';\n\n@Component({\n  moduleId: module.id,\n  selector: 'esl-proposal-list',\n  templateUrl: 'proposal-list.component.html',\n  styleUrls: ['proposal-list.component.css'],\n  providers: [ ProposalService, SortService, FilterService ]\n})\n\nexport class ProposalListComponent implements OnInit {\n\n    @Output() onEdit: EventEmitter<Proposal> = new EventEmitter<Proposal>();\n\n    proposals: Proposal[];\n    proposalCriteria: ProposalCriteria;\n\n    proposalSortedFiltered: Proposal[]; \n    sortByProperties: string[];\n    sortByOrders: string[];\n    sortingIcons: any;\n\n    proposalFilter: Proposal;\n    filterFirstName: string;\n    filterLastName: string;\n    filterManagerName: string;\n    filterCompanyProfile: string;\n    filterNationalWorkProfile: string;\n\n    constructor(private proposalService: ProposalService, private sortService: SortService, private filterService: FilterService) {}\n\n    ngOnInit(): void {\n\n        // change proposalCriteria!!!\n        this.proposalCriteria = null;\n        this.getProposals(this.proposalCriteria);\n\n        this.sortByProperties = [];\n        this.sortByOrders = [];\n        this.sortingIcons = { \n            fisrtName: { asc: false, sort: false },\n            lastName: { asc: false, sort: false },\n            manager: { asc: false, sort: false },\n            companyProfile: { asc: false, sort: false },\n            nationalWorkProfile: { asc: false, sort: false }\n        };\n\n        this.proposalFilter = new Proposal();\n        this.proposalFilter.userAccount = new UserAccount();\n    }\n\n    /**\n     * Get list of proposlas.\n     * \n     * @param criteria ProposalCriteria\n     */\n    getProposals(criteria: ProposalCriteria) {\n\n        this.proposalService.getProposals(criteria).then (\n            proposals => { this.proposals = proposals; \n                            this.proposalSortedFiltered = proposals;\n                            console.log(JSON.stringify(this.proposals)); \n                        }\n        );\n    }\n\n    /**\n     * Emits proposal for the edit modal.\n     */\n    openEditModal(proposal: Proposal) {\n        this.onEdit.emit(proposal);\n    } \n\n    /**\n     * Delets selected propsal.\n     */\n    deleteProposal(proposal: Proposal) {\n        \n        this.proposalService.deleteProposal(proposal).then (\n            proposal => {},\n            reason => {}\n        );\n    }\n\n    /**\n     * Set sorting state arrays sortByProperties and sortByOrders by given parameters. \n     * \n     * @param columnName string; Variabile to add sort para,eter to sortByProperties array.\n     * @param columnNameIcon string; Variable to manage the state of fa-sort icon.\n     */\n    sortByColumn(columnName: string, columnNameIcon: string) {\n\n        // this.proposalsSorted = this.sortService.sortArray(this.proposals, columnName, columnNameIcon,\n        //                                                      this.sortByProperties, this.sortByOrders, this.sortingIcons);\n\n        let index = this.sortByProperties.indexOf(columnName);\n        let isInSortArray =  index !== -1;\n\n        if (isInSortArray) {\n            if (this.sortByOrders[index] == 'asc') {\n\n                this.sortByOrders[index] = 'desc';\n\n                this.sortingIcons[columnNameIcon].asc = false;\n                this.sortingIcons[columnNameIcon].sort = true;\n            }\n            else {\n                _.pullAt(this.sortByProperties,[index]);\n                _.pullAt(this.sortByOrders,[index]);\n\n                this.sortingIcons[columnNameIcon].asc = false;\n                this.sortingIcons[columnNameIcon].sort = false;\n            }\n        } else {\n            // For one column sort:\n            this.sortByProperties = [];\n            this.sortByOrders = [];\n            this.resetSortingIcons();\n            //\n\n            this.sortByProperties.push(columnName);\n            this.sortByOrders.push('asc');\n\n            this.sortingIcons[columnNameIcon].asc = true;\n            this.sortingIcons[columnNameIcon].sort = true;\n        }\n    }\n\n    /**\n     * Reset state of fa-sort icons in sortingIcons object to default values.\n     */\n    resetSortingIcons() {\n        this.sortingIcons = { \n            fisrtName: { asc: false, sort: false },\n            lastName: { asc: false, sort: false },\n            manager: { asc: false, sort: false },\n            companyProfile: { asc: false, sort: false },\n            nationalWorkProfile: { asc: false, sort: false },\n            moneyProposal: { asc: false, sort: false }\n        };\n    }\n\n    /**\n     * Sort and filter proposal array.\n     */\n    proposalSortAndFilter() {\n        this.proposalSortedFiltered = this.proposals;\n\n        // Create filter object.\n        this.proposalFilter = new Proposal();\n        this.proposalFilter.userAccount = new UserAccount();\n        this.proposalFilter.userAccount.firstName = this.filterFirstName;\n        this.proposalFilter.userAccount.lastName = this.filterLastName;\n        this.proposalFilter.manager = this.filterManagerName;\n        this.proposalFilter.companyProfile = this.filterCompanyProfile;\n        this.proposalFilter.nationalWorkProfile = this.filterNationalWorkProfile;\n        console.log('proposalFilter: ' + JSON.stringify(this.proposalFilter));\n\n        // FILTER\n        this.proposalSortedFiltered = this.filterService.filterBy(this.proposals, this.proposalFilter);\n        // SORT\n        this.proposalSortedFiltered = _.orderBy(this.proposalSortedFiltered, this.sortByProperties, this.sortByOrders);  \n    }    \n\n\n    public reload(){\n        this.getProposals(this.proposalCriteria);\n    }\n}"]}